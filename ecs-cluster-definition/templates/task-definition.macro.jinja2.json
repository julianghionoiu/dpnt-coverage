{% macro languageSpecificTask(language, version) -%}
{
  "Type": "AWS::ECS::TaskDefinition",
  "Properties": {
    "Cpu": 1024,
    "RequiresCompatibilities": [
      "FARGATE"
    ],
    "Family": {
      "Fn::Sub": "${ClusterName}-{{ language }}"
    },
    "NetworkMode": "awsvpc",
    "ExecutionRoleArn": "arn:aws:iam::577770582757:role/ecsTaskExecutionRole",
    "TaskRoleArn": {
      "Ref": "TaskRole"
    },
    "Memory": 2048,
    "ContainerDefinitions": [
      {
        "Name": "default-container",
        "Essential": true,
        "Image": {
          "Fn::Sub": "${ContainerRegistryBaseURL}/accelerate-io/dpnt-coverage-{{ language }}:{{ version }}"
        },
        "Environment": [
          {
            "Name": "S3Endpoint",
            "Value": {
              "Ref": "S3Endpoint"
            }
          },
          {
            "Name": "S3Region",
            "Value": {
              "Ref": "S3Region"
            }
          },
          {
            "Name": "SQSEndpoint",
            "Value": {
              "Ref": "SQSEndpoint"
            }
          },
          {
            "Name": "SQSRegion",
            "Value": {
              "Ref": "SQSRegion"
            }
          },
          {
            "Name": "SQSQueueUrl",
            "Value": {
              "Ref": "SQSQueueUrl"
            }
          }
        ],
        "LogConfiguration": {
          "LogDriver": "awslogs",
          "Options": {
            "awslogs-region": {
              "Ref": "AWS::Region"
            },
            "awslogs-group": {
              "Ref": "ClusterTaskExecutionLogGroup"
            },
            "awslogs-stream-prefix": {
              "Fn::Sub": "${ClusterName}-{{ language }}"
            }
          }
        }
      }
    ]
  }
}
{%- endmacro %}